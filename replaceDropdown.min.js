(function(a){a.fn.replaceDropdown=function(c){var d={init:function(d){var c=this;c.replaceDropdown.settings=a.extend({},c.replaceDropdown.defaults,d);return c.each(function(){var d=a(this),g=this,f=this.id,e=f+c.replaceDropdown.settings.divIDtext,i,h=a("#"+e);c.replaceDropdown.settings.linkText=c.replaceDropdown.settings.linkText||d.find("option").eq(0).text();e=b.buildDropdown(d,g,c);d.css({position:"absolute",left:"-99999px"});b.initEvents(e,c)})}},b={initEvents:function(a,c){b.setEventsForDropdown(a,c);b.assignDropdownLinkEvents();b.closeDropdown(a)},buildDropdown:function(c,f,e){for(var g=f.id+e.replaceDropdown.settings.divIDtext,h=f.id+e.replaceDropdown.settings.linkIDtext,b=c.find("option"),d='<div id="'+g+'" class="ddlist">\n<a href="#" id="'+h+'">'+e.replaceDropdown.settings.linkText+"</a>\n<ul>\n",a=0;a<b.length;a++)d+='<li><a href="'+b.eq(a).text()+'" rel="'+b.eq(a).val()+'">'+b.eq(a).text()+"</a></li>\n";d+="</ul>\n</div>\n";c.next("button").remove();c.after(d);return g},setEventsForDropdown:function(d,e){var c=a("#"+d);c.unbind().click(function(f){f.preventDefault();f.stopPropagation();var i=c.attr("id");a(".dropdown.open:not('#"+i+"')").each(function(){b.closeDropdown(this.id)});if(a(this).hasClass("open")==false&&a(this).hasClass("disabled")==false){var h=a(this).find("a.selected").parent().index(),g=25*h;e.replaceDropdown.settings.flipTop&&b.flipDropdown(this,e);$thisUL=a(this).find("ul");$thisUL.scrollTop(g);$thisUL.css({visibility:"visible"});$thisUL.slideDown("fast");a(this).addClass("open");a("body").click(function(){a("body").unbind();b.closeDropdown(d)})}else{b.closeDropdown(d);a("body").unbind()}});c.click()},assignDropdownLinkEvents:function(){a(".ddlist ul li a").bind("click",function(d){d.preventDefault();var c=a(this).parents(".ddlist").attr("id").replace("LinkList",""),b=a("#"+c);b.children("option").attr("selected","");b.children("option").eq(a(this).parent().index()).attr("selected","selected");a(".ddlist ul").slideUp("fast");a(this).parents(".ddlist").find("#"+c+"Link").text(a(this).text());b.change()})},closeDropdown:function(c){var b=a("#"+c);if(b.hasClass("open")){b.children("ul").css({visibility:"hidden"});b.removeClass("open");b.find("a").blur()}},flipDropdown:function(b,e){a(b).find("ul").removeClass("showTop");var c=a(b).find("ul").offset().top,f=a(b).parents(e.replaceDropdown.settings.parent).length?a(b).parents(e.replaceDropdown.settings.parent).offset().top:0,d=a(b).find("ul").height()*1+6,g=a(window).height()*1;g-c<d&&c-f>d&&a(b).find("ul").addClass("showTop")}};if(d[c])return d[c].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof c==="object"||!c)return d.init.apply(this,arguments);else a.error('Method "'+c+'" does not exist in replaceDropdown plugin!')};a.fn.replaceDropdown.defaults={divIDtext:"LinkList",linkIDtext:"Link",linkText:"",parent:"",flipTop:false,ddClass:""};a.fn.replaceDropdown.settings={}})(jQuery);